---
title: pytorch推理模式
date: 2024.12.16
comments: true
---

__`torch.inference_mode()`__：专为推理设计，提供更好的性能，适合高性能推理场景。

__`torch.no_grad()`__：通用的禁用梯度计算方法，适用于任何需要禁用梯度的场景。

| 特性             | `torch.inference_mode()`           | `torch.no_grad()`                                      |
| ---------------- | ---------------------------------- | ------------------------------------------------------ |
| __禁用梯度计算__ | 是                                 | 是                                                     |
| __性能优化__     | 进行额外的性能优化，适用于推理阶段 | 无额外优化，仅禁用梯度计算                             |
| __使用场景__     | 主要用于模型推理阶段               | 可用于任何需要禁用梯度计算的场景，包括训练过程中的验证 |
| __支持的操作__   | 可能会对某些操作进行优化或限制     | 更加通用，适用于所有场景                               |
| __上下文管理器__ | 是                                 | 是                                                     |


